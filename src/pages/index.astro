---
import { getCollection } from 'astro:content';
import FormattedDate from '../components/FormattedDate.astro';
import Layout from '../layouts/Layout.astro';
import { SITE_DESCRIPTION, LINKEDIN_URL } from '../consts';

const posts = (await getCollection('blog')).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);
const recentPosts = posts.slice(0, 5);
---

<Layout title="GenAI System Design — Ashish Bhutani">
	<main>
		<section class="hero">
			<h1>GenAI System Design</h1>
			<p class="subtitle">{SITE_DESCRIPTION}</p>
		</section>

		<section class="intro">
			<p>
				This blog covers the practical side of building and scaling GenAI systems in production. Topics include LLM inference optimization (prefill, decode, speculative decoding), memory management (KV cache, PagedAttention), vector search and RAG pipelines, embedding models, and the infrastructure decisions that come up when serving large language models at scale. Written from an engineering perspective — no hype, just how things actually work under the hood.
			</p>
		</section>

		<section class="recent-posts">
			<h2>Recent Posts</h2>
			<ul>
				{recentPosts.map((post) => (
					<li>
						<a href={`/blog/${post.id}/`}>
							<div class="post-meta">
								<FormattedDate date={post.data.pubDate} />
								{post.data.tags && post.data.tags.length > 0 && (
									<div class="tags">
										{post.data.tags.slice(0, 3).map((tag) => (
											<span class="tag">{tag}</span>
										))}
									</div>
								)}
							</div>
							<h3>{post.data.title}</h3>
							<p class="description">{post.data.description}</p>
						</a>
					</li>
				))}
			</ul>
			<div class="view-all">
				<a href="/blog">View all posts →</a>
			</div>
		</section>

		<section class="cta-section">
			<div class="cta-box">
				<h2>Stay in the loop</h2>
				<p>Connect on LinkedIn for new posts and GenAI system design discussions.</p>
				<div class="cta-links">
					<a href={LINKEDIN_URL} target="_blank" rel="noopener noreferrer" class="cta-button">Connect on LinkedIn</a>
					<a href="/rss.xml" class="cta-button cta-secondary">Subscribe via RSS</a>
				</div>
			</div>
		</section>
	</main>
</Layout>

<style>
	.hero {
		text-align: center;
		padding: 3em 1em 2em 1em;
		max-width: 720px;
		margin: 0 auto;
	}
	.hero h1 {
		font-size: 2.5em;
		margin-bottom: 0.5em;
		letter-spacing: -0.02em;
	}
	.subtitle {
		color: rgb(var(--gray));
		font-size: 1.1em;
		line-height: 1.6;
		max-width: 600px;
		margin: 0 auto;
	}

	.intro {
		max-width: 720px;
		margin: 0 auto;
		padding: 0 1em 1.5em 1em;
	}
	.intro p {
		color: rgb(var(--gray));
		font-size: 0.95em;
		line-height: 1.7;
		text-align: center;
	}

	.recent-posts {
		max-width: 720px;
		margin: 0 auto;
		padding: 1em;
	}
	.recent-posts h2 {
		font-size: 1.5em;
		margin-bottom: 1em;
		padding-bottom: 0.5em;
		border-bottom: 2px solid rgb(var(--gray-light));
	}
	.recent-posts ul {
		list-style: none;
		padding: 0;
		margin: 0;
	}
	.recent-posts li {
		margin-bottom: 1.5em;
	}
	.recent-posts li a {
		display: block;
		padding: 1.25em;
		border-radius: 8px;
		text-decoration: none;
		color: inherit;
		border: 1px solid rgb(var(--gray-light));
		transition: box-shadow 0.2s ease, border-color 0.2s ease;
	}
	.recent-posts li a:hover {
		box-shadow: var(--box-shadow);
		border-color: var(--accent);
	}
	.post-meta {
		display: flex;
		align-items: center;
		gap: 0.75em;
		margin-bottom: 0.5em;
		font-size: 0.85em;
		color: rgb(var(--gray));
	}
	.tags {
		display: flex;
		gap: 0.4em;
		flex-wrap: wrap;
	}
	.tag {
		background: rgba(var(--gray-light), 0.7);
		color: rgb(var(--gray-dark));
		padding: 0.15em 0.5em;
		border-radius: 4px;
		font-size: 0.8em;
	}
	.recent-posts h3 {
		margin: 0 0 0.3em 0;
		font-size: 1.25em;
		color: rgb(var(--black));
	}
	.description {
		margin: 0;
		color: rgb(var(--gray));
		font-size: 0.9em;
		line-height: 1.5;
		display: -webkit-box;
		-webkit-line-clamp: 2;
		-webkit-box-orient: vertical;
		overflow: hidden;
	}
	.view-all {
		text-align: center;
		margin-top: 1em;
	}
	.view-all a {
		font-weight: 700;
	}

	.cta-section {
		max-width: 720px;
		margin: 2em auto;
		padding: 1em;
	}
	.cta-box {
		text-align: center;
		padding: 2em;
		border-radius: 12px;
		background: linear-gradient(135deg, rgba(var(--gray-light), 0.5), rgba(var(--gray-light), 0.2));
		border: 1px solid rgb(var(--gray-light));
	}
	.cta-box h2 {
		font-size: 1.3em;
		margin-bottom: 0.5em;
	}
	.cta-box p {
		color: rgb(var(--gray));
		margin-bottom: 1.5em;
	}
	.cta-links {
		display: flex;
		gap: 1em;
		justify-content: center;
		flex-wrap: wrap;
	}
	.cta-button {
		display: inline-block;
		padding: 0.6em 1.5em;
		border-radius: 6px;
		text-decoration: none;
		font-weight: 700;
		font-size: 0.9em;
		background: var(--accent);
		color: white;
		transition: opacity 0.2s ease;
	}
	.cta-button:hover {
		opacity: 0.85;
		color: white;
	}
	.cta-secondary {
		background: transparent;
		border: 2px solid var(--accent);
		color: var(--accent);
	}
	.cta-secondary:hover {
		background: var(--accent);
		color: white;
	}

	@media (max-width: 720px) {
		.hero h1 {
			font-size: 1.8em;
		}
		.subtitle {
			font-size: 0.95em;
		}
	}
</style>
